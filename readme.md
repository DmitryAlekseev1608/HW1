  Что было сделано?

   1 этап. EDA по имеющимся datasets train и test с проработкой datasets.
   1) Присвоил значение NAN ячейке, где значения вообще были пропущены.
   2) Были подсчитаны основные статистики по числовым и категориальным признакам.
   3) Были найдены пропуски в datasets.
   4) Был произведен поиск объектов с одинаковым признаковым значением. В результате
было обнаружено 1159 строк, которые дублируют уже имеющиеся строки в ДатаФрейме.
   5) Дубляж строк был удален.
   6) Произведено после всех преобразований обновление индексов.
   7) Для признаков  mileage, engine и max_power были
удалены их единицы измерения, также столбцы были преобразованы во float.
   8) Столбец torque был преобразован с использованием регулярных выражений и разделен
на 2 столбца max_torque_rpm и torque.
   9) Был произведен поиск пропусков и их замена в train на медиану, а в test на медиану train.
   10) Было произведено большое множество других преобразований, таких как преобразование типа данных.
   
   2 этап. Визуализация данных.
   1) Были получены и проанализированы попарные распределения числовых признаков.
   2) Найдены значения корреляций между признаками и проанализированы.
   3) Получена тепловая карта.
   4) Получены диаграммы рассеивания.
   
   3 этап. Построение модели на вещественных признаках.
   1) Была обучена модель линейной регрессии, найдены ее предикты, получена оцена MSE и r2.
   2) Была обучена модель линейной регрессии, найдены ее предикты, получена оцена MSE и r2 на стандартизованных данных.
   3) Была обучена модель линейной регрессии c L1-регуляризацией (Lasso), найдены ее предикты, получена оцена MSE и r2.
Дополнительно был произведен поиск наилучших гиперпараметров и обучение модели на них.
   4) Была обучена модель ElasticNet на предварительно найденных значениях гиперпараметров, найдены ее предикты,
получена оцена MSE и r2.

   4 этап. Построение модели на вещественных и категориальных признаках.
   1) Преобразованы категориальные признаки. Рассмотрены два способа через get_dammies и OneHotEncoding. Так как гораздо проще OneHotEncoding ввиду придания методом 
гибкости модели, первый способ я закоментил, но оставил.
   2) Была обучена модель линейной регрессии c L2-регуляризацией (Ridge), найдены ее предикты, получена оцена MSE и r2.
Дополнительно был произведен поиск наилучших гиперпараметров и обучение модели на них.
 
   5 этап. Бонусная.
   Добавил два вещественных признака мощность на единицу объема двигателя и год в квадрате. Удалось увеличить еще больше r2-score.
   Модель Ridge была сохранена в файл .pickle.

   6 этап. Бизнесовая часть.
   Была введена новая метрика, зависящаю от количества доли предиктов, отличающихся от реальных цен.

   С какими результатами?
   1) 1159 строк дублирующих уже имеющиеся в датасете train;
   2) Из построенных распределений можно сделать следующие выводы зависимости целевой переменной от признаков:
Видно что с годом выпуска (year) цена на машину (selling_price) увеличивается. Чем более новая машина, тем она дороже.
При увеличении пробега (km_driven) и расхода (mileage) цена на машину (selling_price) уменьшается.
При увеличении мощности (max_power) и объема двигателя (engine) цена на машину (selling_price) растет.
С увеличением количества мест (seats) цена на машину (selling_price) падает. Тут я думаю дело в том, что самый топ сегмент
это 5-ти местные стандартные машины, спрос на них наивысок. Хотя, что странно, коэффициент корреляции между ними маленький,
но положительный, что говорит об обратном и что я не вижу на графике.
Цена на машину (selling_price) практически не зависит от максимального крутящего момента (max_torque_rpm),
но при увеличении крутящего момента (torque) цена (selling_price) незначительно возрастает.
   3) Самые большие корреляции между признаками обнаружены между (без учета целевой переменной - цена автомобиля):
- годом выпуска авто (year) и пробегом (km_driven);
- расходом (mileage) и объемом двигателя (engine);
- объемом двигателя (engine) и мощностью (max_power);
- максимальным крутящим моментом (max_torque_rpm) и пробегом (km_driven);
- крутящим моментом (torque) и максимальной мощностью (max_power);
- объемом двигателя (engine) и числом мест (seats).
При этом, цена на авто (selling_price) наиболее взаимосвязана с мощностью двигателя (max_power).
   4) Совокупности оказались похожими, что видно не только по графическим отображениям зависимостей,
но и по выведенным значениям коэффициентов коррекляции.
   5) По оценке коэффициентов корреляции:
1. Наименее скоррелированными между собой признаками по данным train являются цена продажи (selling_price)
и максимальный крутящий момент (max_torque_rpm).
2. Cильная положительная линейная зависимость наблюдается между мощностью двигателя (max_power) и целевой 
переменной цена продажи (selling_price). Если рассматривать только признаки, то это мощностью двигателя (max_power) 
и его объем (engine).
3. Данное утверждение не верно. Есть авто с более поздним годом выпуска, но с большим пробегом. Зависимость года выпуска 
от пробега более похоже на нормальное распределение.
4. Модель                             |   r2-score на train  |   r2-score на test
   LinearRegression                   |   0.60               |   0.60
   
   После стандартизации данных:

   Модель                             |   r2-score на train  |   r2-score на test
   LinearRegression                   |   0.60               |   0.60
   Lasso(alpha = 1)                   |   0.60               |   0.60
   Lasso(alpha = 990)                 |   0.60               |   0.60
   ElasticNet                         |   0.60               |   0.60

   После добавления категориальных признаков:
   
   Модель                             |   r2-score на train  |   r2-score на test
   Ridge (категорирование get_dammies)|   0.665              |   Не стал искать
   Ridge (категорирование OneHotEnc. )|   0.666              |   0.616   
 
   После добавления новых признаков:
   Модель                             |   r2-score на train  |   r2-score на test
   Ridge (категорирование get_dammies)|   0.673              |   - 
   Ridge (категорирование OneHotEnc. )|   0.673              |   0.636   

5. В результате анализа дополнительной метрики получилось 0.017% цен отличаются от фактичесих не более чем на 10% для train.
Ничтожное количество, но r2-score также получился довольно таки не большим. 0.1 % для test.

6. Сервер был реализован только для одной машины. Для списска я не успел по времени. Репозиторий с сервером приложен.
Реализована именно модель с самой высокой точность на большом наборе данных. Тестовые данные приложены к решению для 
их копирования в строку на хосте в папке "Сервис".

Работа сервиса выполнена просто.
1) Введем исходные данные:

{
  "year": 2010,
  "max_torque_rpm": 2200,
  "km_driven": 168000,
  "mileage": 14,
  "engine": 2498,
  "max_power": 112,
  "torque": 260,
  "max_power_engine": 0.05,
  "fuel": "Diesel",
  "seller_type": "Individual",
  "transmission": "Manual",
  "owner": "First Owner",
  "seats": "5.0"
}

2) Выполняем код и получаем ответ с предсказанной ценой автомобиля 616350.
Принт скрин приложен в папке "Сервис".
Для того чтобы реализовать сервис я передал в него саму модель, обученные классы StandartScaller и OneHotEncoding.
Также приложил файл Unttiled.ipynb, в котором также реализован этот сервис но в ноутбуке. Я его сделал, чтобы можно было изучить,
как будет работать код на сервере.

Вторую часть задачи по сервису я не успел сделать в обозначенный срок. Хотя оставалась не так много.












